{extend name="Template:base" /}
{block name="title"}基因检测-商品管理{/block}
{block name="other_css"}
<!-- other css -->
<style>
    .datagrid-body {
        overflow-x: scroll;
    }
    .pd-txt{
        margin-bottom:10px;
    }
</style>
{/block}
{block name="class"}{/block}
{block name="body"}
<table id="orderList" width="100%"></table>
<div id="win" class="easyui-window" title="添加" style="width:300px;height:300px"
     data-options="iconCls:'icon-edit',modal:true,closed:false,minimizable:false">
    <div class="easyui-panel" data-options="fit:true" style="padding:10px;">
        <form id="ff" method="post">
            <div class="pd-txt">
                <input class="easyui-validatebox easyui-textbox" style="width:100%" type="text" name="name"
                       data-options="label:'商品名称：',required:true,missingMessage:'请输入商品名称'"/>
            </div>
            <div class="pd-txt">
                <input class="easyui-validatebox easyui-numberbox" style="width:100%" type="text" name="price"
                       data-options="label:'价格：',required:true,missingMessage:'请输入价格'"/>
            </div>
            <div class="pd-txt">
                <input class="easyui-validatebox easyui-filebox" style="width:100%" type="text" name="cover"
                       data-options="label:'图片：',required:true,missingMessage:'请选择图片',buttonText:'选择图片', accept:'image/jpeg,image/png'"/>
            </div>
            <div class="pd-txt">
                <input class="easyui-validatebox easyui-textbox" style="width:100%" type="text" name="body"
                       data-options="label:'描述：',required:false"/>
            </div>
            <div style="text-align:center;padding:5px 0">
                <a href="javascript:void(0)" class="easyui-linkbutton" onclick="submitForm()" style="width:80px">保存</a>
            </div>
        </form>
    </div>
</div>
{/block}
{block name="other_js"}
<script>
    $('#orderList').datagrid({
        url: "{:url('Index/goods')}",
        method: "POST",
        pagination: true,
        striped: true,
        singleSelect: true,
        pagePosition: 'top',
        columns: [[
            {field: 'id', title: 'ID', width: 50, align: 'center', checkbox: true},
            {field: 'subject', title: '商品名称', width: 150, align: 'center', editor: 'text'},
            {field: 'price', title: '价格', width: 70, align: 'center'},
            {field: 'body', title: '描述', width: 200, align: 'center'},
            {
                field: 'cover', title: '图片', width: 300, align: 'center', fixed: true,
                formatter: function (value, row, index) {
                    var img = '<img src="__COMMONRESOURCE__/images/slider/' + value + '" height="100" width="300" title="' + value + '" alt="' + value + '" />'
                    return img;
                }
            },
            {field: 'create_time', title: '创建时间', width: 150, align: 'center'},
            {field: 'update_time', title: '更新时间', width: 150, align: 'center'},
            {
                field: 'action', title: '操作', width: 150, align: 'center', formatter: function (value, row, index) {
                    var e = '<a href="#" onclick="editrow(' + index + ')">Edit</a>';
                    return e;
                }
            }
        ]],
        toolbar: [{
            iconCls: 'icon-add',
            handler: function () {

            }
        }, '-', {
            id: 'btn_remove',
            iconCls: 'icon-remove',
            disabled: true,
            handler: function () {
                var rowdata = $('#orderList').datagrid('getSelected');
            }
        }],
        onCheck: function (rowIndex, rowData) {
            $('#btn_remove').linkbutton("enable");
        },
        onLoadSuccess: function (data) {
            $('#btn_remove').linkbutton("disable");
        }
    });
    $('#orderList').datagrid('getPager').pagination({
        beforePageText: '第',
        afterPageText: '页，共 {pages} 页',
        displayMsg: '当前显示 {from} - {to} 条记录，共 {total} 条记录',
    });

    function editrow(row) {
        $('#orderList').datagrid('selectRow', row);
        var rowdata = $('#orderList').datagrid('getSelected');

    }

    $.extend($.fn.validatebox.defaults.rules, {
        number: {
            validator: function (value) {
                var re = /\D/;
                return !re.test(value);
            },
            message: '请输入数字.'
        }
    });

</script>
{/block}