{extend name="Template:base" /}
{block name="title"}基因检测-查询结果{/block}
{block name="other_css"}
<!-- other css -->
<link rel='stylesheet' href='__MOBILERESOURCE__/css/login.css' type="text/css"/>
{/block}
{block name="body"}
<div class="wrapper">
    <div class="contents">
        <div class="content-1">
            <div class="select-order">请输入手机号</div>
            <div class="content-box">
                <div class="form-detail">
                    <input class="form-control" placeholder="请输入手机号" id="phone" value=""/>
                    <span class="fenge"></span>
                    <a class="huoqu" href="javascript:;" id="send_code">获取验证码</a>
                </div>
                <div class="form-detail">
                    <input class="form-control-a" placeholder="请输入验证码" id="code" value=""/>
                </div>
            </div>
            <div class="content-bottom">
                <a class="form-img" onclick="login();" href="javascript:;">确定</a>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="other_js"}
<!-- other js -->
<script>

    $("#send_code").click(function () {
        if($(this).hasClass('active')){
            return;
        }
        var mobile = $("#phone").val();
        if (mobile == '') {
            alert('请输入手机号');
            return;
        }
        $("#send_code").addClass('active');
        var second = 20;
        $("#send_code").val(second + 's');
        var interval = setInterval(function () {
            second -= 1;
            if (second == 0) {
                clearInterval(interval);
                $("#send_code").removeClass('active');
                $("#send_code").html('获取验证码');
            } else {
                $("#send_code").html(second + 's');
            }
        }, 1000);
        var sendUrl = "{:url('User/sendSms')}";
        $.post(sendUrl, {
            mobile: mobile,
            type: 'login'
        }, function (res) {
            if (res.status_code != 200) {
                alert(res.msg);
                clearInterval(interval);
                $("#send_code").removeClass('active');
                $("#send_code").html('获取验证码');
            }else{
                alert(res.msg);
            }
        })
    });



    function login() {
        var mobile = $("#phone").val();
        var code = $("#code").val();
        var url = "{:url('User/login')}";
        $.post(url, {mobile:mobile,code:code}, function (res) {
            if (res.status_code == '200') {
                window.location.href = "{:url('Index/index')}";
            } else {
                alert(result.msg);
            }
        });
    }
</script>
{/block}
